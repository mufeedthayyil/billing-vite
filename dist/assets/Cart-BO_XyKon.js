import{c as e,u as s,a,j as t,S as r,B as l,b as n,f as i,o as c}from"./index-C3XHl7PL.js";import{r as d}from"./vendor-Df-ZC91g.js";import{u as m,L as o}from"./router-BW3qfFDS.js";import{C as x,c as h,a as p,b as u}from"./Card-DqtHJJQK.js";import{I as j}from"./Input-BAszwOqE.js";import{A as g}from"./Alert-D6Ms3eos.js";import{P as y}from"./plus-BbCtciMK.js";import{T as f}from"./trash-2-rN2tfj1E.js";import"./supabase-C0-OQ20D.js";
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const b=e("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),N=e("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),v=()=>{const{items:e,removeFromCart:v,updateQuantity:C,clearCart:q,getTotalCost:w}=s(),{user:S,isAuthenticated:k}=a(),_=m(),[z,P]=d.useState({name:(null==S?void 0:S.name)||"",email:(null==S?void 0:S.email)||"",phone:""}),[A,D]=d.useState(!1),[O,L]=d.useState(null),[T,B]=d.useState(null),E=e=>{const{name:s,value:a}=e.target;P(e=>({...e,[s]:a}))};return 0===e.length?t.jsx("div",{className:"min-h-screen bg-gray-50",children:t.jsx("div",{className:"max-w-4xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:t.jsxs("div",{className:"text-center py-12",children:[t.jsx(r,{size:64,className:"mx-auto text-gray-400 mb-4"}),t.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Your cart is empty"}),t.jsx("p",{className:"text-gray-600 mb-6",children:"Browse our equipment and add items to your cart to get started."}),t.jsx(o,{to:"/",children:t.jsx(l,{icon:t.jsx(b,{size:16}),children:"Browse Equipment"})})]})})}):t.jsx("div",{className:"min-h-screen bg-gray-50",children:t.jsxs("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"mb-6",children:[t.jsxs(o,{to:"/",className:"inline-flex items-center text-primary-600 hover:text-primary-700 mb-4",children:[t.jsx(b,{size:16,className:"mr-1"}),"Continue Shopping"]}),t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Shopping Cart"}),t.jsx("p",{className:"text-gray-600",children:"Review your selected equipment and proceed to checkout"})]}),O&&t.jsx(g,{variant:"error",className:"mb-6",onClose:()=>L(null),children:O}),T&&t.jsx(g,{variant:"success",className:"mb-6",children:T}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[t.jsx("div",{className:"lg:col-span-2 space-y-4",children:e.map(e=>t.jsx(x,{children:t.jsx(h,{className:"p-6",children:t.jsxs("div",{className:"flex items-start space-x-4",children:[t.jsx("img",{src:e.equipment.image_url||"https://images.pexels.com/photos/90946/pexels-photo-90946.jpeg?auto=compress&cs=tinysrgb&w=400",alt:e.equipment.name,className:"w-20 h-20 object-cover rounded-md"}),t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:e.equipment.name}),t.jsx("p",{className:"text-sm text-gray-600 mb-2",children:e.equipment.description}),t.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600",children:[t.jsxs("span",{children:["Duration: ",e.duration]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:["Rent: ",n(e.rentDate)]}),t.jsx("span",{children:"•"}),t.jsxs("span",{children:["Return: ",n(e.returnDate)]})]}),t.jsxs("div",{className:"flex items-center justify-between mt-4",children:[t.jsxs("div",{className:"flex items-center space-x-2",children:[t.jsx("button",{onClick:()=>C(e.equipment.id,e.quantity-1),className:"p-1 rounded-md border border-gray-300 hover:bg-gray-50",children:t.jsx(N,{size:16})}),t.jsx("span",{className:"w-8 text-center",children:e.quantity}),t.jsx("button",{onClick:()=>C(e.equipment.id,e.quantity+1),className:"p-1 rounded-md border border-gray-300 hover:bg-gray-50",children:t.jsx(y,{size:16})})]}),t.jsxs("div",{className:"flex items-center space-x-4",children:[t.jsx("span",{className:"text-lg font-semibold text-primary-600",children:i(e.totalCost)}),t.jsx("button",{onClick:()=>v(e.equipment.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-md",children:t.jsx(f,{size:16})})]})]})]})]})})},e.equipment.id))}),t.jsxs("div",{className:"space-y-6",children:[t.jsxs(x,{children:[t.jsx(p,{children:t.jsx(u,{children:"Customer Information"})}),t.jsxs(h,{className:"space-y-4",children:[t.jsx(j,{label:"Customer Name",name:"name",value:z.name,onChange:E,required:!0}),t.jsx(j,{label:"Email Address",name:"email",type:"email",value:z.email,onChange:E,required:!0}),t.jsx(j,{label:"Phone Number",name:"phone",value:z.phone,onChange:E,placeholder:"+91 9876543210"})]})]}),t.jsxs(x,{children:[t.jsx(p,{children:t.jsx(u,{children:"Order Summary"})}),t.jsxs(h,{children:[t.jsxs("div",{className:"space-y-3",children:[e.map(e=>t.jsxs("div",{className:"flex justify-between text-sm",children:[t.jsxs("span",{children:[e.equipment.name," × ",e.quantity]}),t.jsx("span",{children:i(e.totalCost)})]},e.equipment.id)),t.jsx("div",{className:"border-t border-gray-200 pt-3",children:t.jsxs("div",{className:"flex justify-between font-semibold text-lg",children:[t.jsx("span",{children:"Total"}),t.jsx("span",{className:"text-primary-600",children:i(w())})]})})]}),t.jsx("div",{className:"mt-6",children:k?"customer"===(null==S?void 0:S.role)?t.jsxs("div",{className:"text-center",children:[t.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Only staff members can create orders. Please contact our team to complete your rental."}),t.jsx(l,{variant:"outline",fullWidth:!0,disabled:!0,children:"Contact Staff"})]}):t.jsx(l,{fullWidth:!0,onClick:async()=>{if(k)if("staff"===(null==S?void 0:S.role)||"admin"===(null==S?void 0:S.role))if(z.name&&z.email){D(!0),L(null);try{const s=e.map(e=>c.create({customer_name:z.name,customer_email:z.email,customer_phone:z.phone,equipment_id:e.equipment.id,duration:e.duration,rent_date:e.rentDate,return_date:e.returnDate,total_cost:e.totalCost,handled_by:S.id,status:"confirmed"}));await Promise.all(s),B(`Successfully created ${e.length} order(s)!`),q(),setTimeout(()=>{_("/orders")},2e3)}catch(s){L("Failed to create orders. Please try again."),console.error("Error creating orders:",s)}finally{D(!1)}}else L("Please fill in all customer information");else L("Only staff and admin can create orders. Please contact support.");else _("/login?redirect=/cart")},isLoading:A,disabled:A||!z.name||!z.email,children:A?"Creating Order...":"Create Order"}):t.jsx(o,{to:"/login?redirect=/cart",children:t.jsx(l,{fullWidth:!0,children:"Login to Checkout"})})})]})]})]})]})]})})};
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */export{v as default};
